# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Ilc < Formula
  desc "Simplify creating command-line utilities"
  homepage "https://github.com/evilmarty/ilc"
  version "0.19.0"
  license "GPL"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/evilmarty/ilc/releases/download/v0.19.0/ilc-0.19.0-darwin_amd64"
      sha256 "c1965da99cf96430141ac7945fbd185c6b6d58f39b4190be4d6da5c729088bd4"

      def install
        if head?
          ldflags = %W[
            -s -w -X main.BuildDate=#{time.iso8601} -X main.Version=#{version} -X main.Commit=#{Utils.git_head}
          ]
          system "go", "build", *std_go_args(ldflags:)
        else
          bin.install Dir["#{name}-*"].first => name
        end
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/evilmarty/ilc/releases/download/v0.19.0/ilc-0.19.0-darwin_arm64"
      sha256 "dafeb95082ef8bc02527706e4806837feddd554c911d4d014190591d9ae71347"

      def install
        if head?
          ldflags = %W[
            -s -w -X main.BuildDate=#{time.iso8601} -X main.Version=#{version} -X main.Commit=#{Utils.git_head}
          ]
          system "go", "build", *std_go_args(ldflags:)
        else
          bin.install Dir["#{name}-*"].first => name
        end
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      if Hardware::CPU.is_64_bit?
        url "https://github.com/evilmarty/ilc/releases/download/v0.19.0/ilc-0.19.0-linux_amd64"
        sha256 "e2aa6948c9d7deeb3b8b2378c489fbf8296e7ed64ded8af10473e9db61c551f0"

        def install
          if head?
            ldflags = %W[
              -s -w -X main.BuildDate=#{time.iso8601} -X main.Version=#{version} -X main.Commit=#{Utils.git_head}
            ]
            system "go", "build", *std_go_args(ldflags:)
          else
            bin.install Dir["#{name}-*"].first => name
          end
        end
      end
    end
    if Hardware::CPU.arm?
      if !Hardware::CPU.is_64_bit?
        url "https://github.com/evilmarty/ilc/releases/download/v0.19.0/ilc-0.19.0-linux_armv6"
        sha256 "2291582ebd55e0c5671d7c00a156ddd82b8b99def3bf06e3d5f314d8ab3b4ed8"

        def install
          if head?
            ldflags = %W[
              -s -w -X main.BuildDate=#{time.iso8601} -X main.Version=#{version} -X main.Commit=#{Utils.git_head}
            ]
            system "go", "build", *std_go_args(ldflags:)
          else
            bin.install Dir["#{name}-*"].first => name
          end
        end
      end
    end
    if Hardware::CPU.arm?
      if Hardware::CPU.is_64_bit?
        url "https://github.com/evilmarty/ilc/releases/download/v0.19.0/ilc-0.19.0-linux_arm64"
        sha256 "3c7446f4e875a6d159afd2bb0e0adc2cea6ee94adb3e30706bfb51e975815b2f"

        def install
          if head?
            ldflags = %W[
              -s -w -X main.BuildDate=#{time.iso8601} -X main.Version=#{version} -X main.Commit=#{Utils.git_head}
            ]
            system "go", "build", *std_go_args(ldflags:)
          else
            bin.install Dir["#{name}-*"].first => name
          end
        end
      end
    end
  end

  head do
    url "https://github.com/evilmarty/ilc.git", branch: "main"
    depends_on "go" => :build
  end

  test do
    version_output = shell_output(bin/"ilc -version")
    assert_match "Version: #{version}", version_output
  end
end
