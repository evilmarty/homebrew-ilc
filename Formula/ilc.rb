# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Ilc < Formula
  desc "Simplify creating command-line utilities"
  homepage "https://github.com/evilmarty/ilc"
  version "0.20.0"
  license "GPL"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/evilmarty/ilc/releases/download/v0.20.0/ilc-0.20.0-darwin_amd64"
      sha256 "ecd30107d495b9c6a90b1ee16add48581aceb4af8bef8eb3d1244db6336befd4"

      def install
        if head?
          ldflags = %W[
            -s -w -X main.BuildDate=#{time.iso8601} -X main.Version=#{version} -X main.Commit=#{Utils.git_head}
          ]
          system "go", "build", *std_go_args(ldflags:)
        else
          bin.install Dir["#{name}-*"].first => name
        end
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/evilmarty/ilc/releases/download/v0.20.0/ilc-0.20.0-darwin_arm64"
      sha256 "dbf76527eb0d4e8b88a6b2b448f7a8bafec70231d2cdfecea1a390dce3ee53fc"

      def install
        if head?
          ldflags = %W[
            -s -w -X main.BuildDate=#{time.iso8601} -X main.Version=#{version} -X main.Commit=#{Utils.git_head}
          ]
          system "go", "build", *std_go_args(ldflags:)
        else
          bin.install Dir["#{name}-*"].first => name
        end
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      if Hardware::CPU.is_64_bit?
        url "https://github.com/evilmarty/ilc/releases/download/v0.20.0/ilc-0.20.0-linux_amd64"
        sha256 "8b8d650ace497e6a6917c5c36c448d8e49c941ba2649de4d4bd61eff10e99ea8"

        def install
          if head?
            ldflags = %W[
              -s -w -X main.BuildDate=#{time.iso8601} -X main.Version=#{version} -X main.Commit=#{Utils.git_head}
            ]
            system "go", "build", *std_go_args(ldflags:)
          else
            bin.install Dir["#{name}-*"].first => name
          end
        end
      end
    end
    if Hardware::CPU.arm?
      if !Hardware::CPU.is_64_bit?
        url "https://github.com/evilmarty/ilc/releases/download/v0.20.0/ilc-0.20.0-linux_armv6"
        sha256 "77d45ae61f311e7a02ad54bf03074da9e74f57575c72d7d21e0b8da69dee242c"

        def install
          if head?
            ldflags = %W[
              -s -w -X main.BuildDate=#{time.iso8601} -X main.Version=#{version} -X main.Commit=#{Utils.git_head}
            ]
            system "go", "build", *std_go_args(ldflags:)
          else
            bin.install Dir["#{name}-*"].first => name
          end
        end
      end
    end
    if Hardware::CPU.arm?
      if Hardware::CPU.is_64_bit?
        url "https://github.com/evilmarty/ilc/releases/download/v0.20.0/ilc-0.20.0-linux_arm64"
        sha256 "d80390e0ac61bfaee01c72069e4c4a49d32af493a6c1761ef43149bf7f9b13e5"

        def install
          if head?
            ldflags = %W[
              -s -w -X main.BuildDate=#{time.iso8601} -X main.Version=#{version} -X main.Commit=#{Utils.git_head}
            ]
            system "go", "build", *std_go_args(ldflags:)
          else
            bin.install Dir["#{name}-*"].first => name
          end
        end
      end
    end
  end

  head do
    url "https://github.com/evilmarty/ilc.git", branch: "main"
    depends_on "go" => :build
  end

  test do
    version_output = shell_output(bin/"ilc -version")
    assert_match "Version: #{version}", version_output
  end
end
